title: Windows Remote Management
description: The below query (in order) remote process executions through MMC, WMIC,
  and PsExec (by name or display name). Also of note, there are only 3 tests documented
  for this Atomic, yet there are 6 tests, so the below query focuses on detectability.
  PsExec detection may have a lot of noise depending on your environment, and may
  require additional filtering.
author: keyboardcrunch
date: 10/10/2020
modified: null
mitre:
   tactic: Lateral Movement
   technique: T1021
   subtechnique: 006
operating_system: windows
query: (TgtProcCmdLine ContainsCIS "GetTypeFromProgID(" AND TgtProcCmdLine ContainsCIS
  "MMC20.application" AND TgtProcCmdLine ContainsCIS ".Document.ActiveView.ExecuteShellCommand(")
  OR (TgtProcName = "wmic.exe" AND TgtProcCmdLine ContainsCIS "/node:" AND TgtProcCmdLine
  ContainsCIS "process call create") OR ((SrcProcName ContainsCIS "psexec.exe" OR
  SrcProcDisplayName = "Execute processes remotely") AND DstIp Is Not Empty)
false_positives: null
tags: null

